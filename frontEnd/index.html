<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>Front End</title>

  </head>

  <body>
    Year: <select id="year_dropdown" onchange="retrieve_data()"></select>
    Week: <select id="week_dropdown" onchange="retrieve_data()"></select>
    <div id="root"></div>
    <script>
    const app = document.getElementById('root')

    //Create dropdown menus
    const year_dropdown = document.getElementById('year_dropdown')
    const week_dropdown = document.getElementById('week_dropdown')

    var year_list = ["2017", "2018"]
    var option_text
    for(option_text in year_list) {
      var option = document.createElement("option")
      option.text = year_list[option_text]
      year_dropdown.add(option)
    }

    for(var i = 1; i < 17; i++) {
      var option = document.createElement("option")
      option.text = i
      week_dropdown.add(option)
    }

    const container = document.createElement('div')
    container.setAttribute('class', 'container')

    app.appendChild(container)


    function retrieve_data() {
      var request = new XMLHttpRequest()
      request.open('GET', 'https://fchv75rdm1.execute-api.us-east-1.amazonaws.com/default/travisAccessLambda?year=' + year_dropdown.value + '&week=' + week_dropdown.value, true)
      request.onload = function() {
        // Begin accessing JSON data here
        var data = JSON.parse(this.response)
        container.innerHTML = ''
        if (request.status >= 200 && request.status < 400) {
          data.forEach(game => {

            const h1 = document.createElement('h1')
            h1.textContent = game.away + " vs. " + game.home

            const p = document.createElement('p')
            p.textContent = `${game.score}`

            container.appendChild(h1)
            container.appendChild(p)
          })
        } else {
          const errorMessage = document.createElement('marquee')
          errorMessage.textContent = `Something went wrong.`
          app.appendChild(errorMessage)
        }
      }
      request.send()
    }

    retrieve_data()
    </script>
  </body>
</html>